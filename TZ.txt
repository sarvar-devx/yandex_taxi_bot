
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Yandex Taxi Bot =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

Taxi Go:
    Login register:
        Ism,
        Familiya,
        Telefon raqami,
        O'z rasminggiz,
        Avtomobil toifasi,
        Davlat raqami,
        Litsenziya muddati

    Lokation:
        Klent lokatsiyasi
        Mazil lokatsiyasi

    Masofa:
        Masofa hisoblanishi kerak
        Nechi daqiqada mijozga  etib briladi
        Nechi daqiqada manzilga etib boriladi

    To'lov:
        Mijoz cartada to'lov qiladi
        Mijoz naqt to'lov qiladi

    Aloqa:
        Mijoz raqami:

    Qoshimcha:
        Yuk bilan
        Yuksiz

    Xabar:
        Mijozgacha XX daqiqa qoldi
        Manzilgacha XX daqiqa qoldi
        Taxi etib keldi,
        Taxi kutyapti,
        Tirbandlikda

Taxi klient:
    Login:
        telefon raqam,

    Mazil:
        Mashina lokatsiyasi
        qanchada etib kelishi
        Narxi

    To'lov:
        Naqd,
        Carta

    Toifa:
        Start,
        Comfort
        Biznes+

    Kim ketadi
        Men:
            Yuk bilan,
            yuksiz

        Boshqa:
            D'stim,
            Olia a'zolarim
            Boshqa

        Qo'shimcha
            Yuk bilan,
            YUksiz

    Xabarlar:
        Taxi kelyapti,
        Taxi XX daqiqada keladi
        Mazilga XX daqiqa qoldi
        Taxi keldi,
        Qidirlmoqda,
        Taxi 5 daqiqa kutadi,
        Comment
        Safarni bekor qilish
            Sabablari:
                Juda uzoq kutiladi,
                Rejalar o'zgardi
                Mashina rusumi yoqmadi,
=====================================================================================================

.PHONY: run install setup clean test

run:
	python main.py

install:
	pip install -r requirements.txt

setup:
	python -m venv .venv
	.venv/bin/pip install -r requirements.txt

clean:
	find . -type d -name "__pycache__" -delete
	find . -name "*.pyc" -delete

test:
	python -m pytest tests/ -v


# AKEM_BOT Docker Makefile

.PHONY: help build up down restart logs logs-bot logs-db status clean backup shell shell-db

# Standart buyruq - yordam ko'rsatish
help:
	@echo "AKEM_BOT Docker buyruqlari:"
	@echo ""
	@echo "ðŸš€ Asosiy buyruqlar:"
	@echo "  make build     - Docker image yaratish"
	@echo "  make up        - Botni ishga tushirish (loglar bilan)"
	@echo "  make up-d      - Botni fonda ishga tushirish"
	@echo "  make down      - Botni to'xtatish"
	@echo "  make restart   - Botni qayta ishga tushirish"
	@echo ""
	@echo "ðŸ“Š Monitoring:"
	@echo "  make logs      - Barcha loglarni ko'rish"
	@echo "  make logs-bot  - Faqat bot loglarini ko'rish"
	@echo "  make logs-db   - Faqat database loglarini ko'rish"
	@echo "  make status    - Konteynerlar holatini ko'rish"
	@echo ""
	@echo "ðŸ› ï¸  Boshqaruv:"
	@echo "  make shell     - Bot konteyneriga kirish"
	@echo "  make shell-db  - PostgreSQL ga kirish"
	@echo "  make backup    - Ma'lumotlar bazasi backup"
	@echo "  make clean     - Barcha konteyner va volumelarni o'chirish"
	@echo ""
	@echo "âš¡ Tez buyruqlar:"
	@echo "  make dev       - Development rejimi (build + up)"
	@echo "  make prod      - Production rejimi (build + up-d)"

# Docker image yaratish
build:
	@echo "ðŸ”¨ Docker image yaratilmoqda..."
	docker-compose build

# Botni ishga tushirish (loglar bilan)
up:
	@echo "ðŸš€ Bot ishga tushirilmoqda..."
	docker-compose up --build

# Botni fonda ishga tushirish
up-d:
	@echo "ðŸš€ Bot fonda ishga tushirilmoqda..."
	docker-compose up -d --build

# Botni to'xtatish
down:
	@echo "â¹ï¸  Bot to'xtatilmoqda..."
	docker-compose down

# Botni qayta ishga tushirish
restart:
	@echo "ðŸ”„ Bot qayta ishga tushirilmoqda..."
	docker-compose restart akem-bot

# Barcha loglarni ko'rish
logs:
	@echo "ðŸ“‹ Barcha loglar:"
	docker-compose logs -f

# Faqat bot loglarini ko'rish
logs-bot:
	@echo "ðŸ¤– Bot loglari:"
	docker-compose logs -f akem-bot

# Faqat database loglarini ko'rish
logs-db:
	@echo "ðŸ—„ï¸  Database loglari:"
	docker-compose logs -f postgres_db

# Konteynerlar holatini ko'rish
status:
	@echo "ðŸ“Š Konteynerlar holati:"
	docker-compose ps

# Bot konteyneriga kirish
shell:
	@echo "ðŸš Bot konteyneriga kirish..."
	docker-compose exec akem-bot bash

# PostgreSQL ga kirish
shell-db:
	@echo "ðŸ—„ï¸  PostgreSQL ga kirish..."
	docker-compose exec postgres_db psql -U postgres -d akem_bot

# Ma'lumotlar bazasi backup
backup:
	@echo "ðŸ’¾ Ma'lumotlar bazasi backup yaratilmoqda..."
	@mkdir -p backups
	docker-compose exec postgres_db pg_dump -U postgres akem_bot > backups/backup_$(shell date +%Y%m%d_%H%M%S).sql
	@echo "âœ… Backup yaratildi: backups/backup_$(shell date +%Y%m%d_%H%M%S).sql"

# Barcha konteyner va volumelarni o'chirish
clean:
	@echo "ðŸ§¹ Tozalash..."
	docker-compose down -v
	docker system prune -f
	@echo "âœ… Tozalandi!"

# Development rejimi
dev: build up

# Production rejimi
prod: build up-d

# Tez test
test:
	@echo "ðŸ§ª Bot testini o'tkazish..."
	docker-compose exec akem-bot python -c "print('Bot kodi tekshirildi âœ…')"

# Update - yangi kod bilan qayta ishga tushirish
update:
	@echo "ðŸ”„ Bot yangilanmoqda..."
	docker-compose down
	docker-compose up --build -d
	@echo "âœ… Bot yangilandi!"

# Logs tozalash
clear-logs:
	@echo "ðŸ§¹ Loglarni tozalash..."
	docker-compose down
	docker system prune -f --volumes
	@echo "âœ… Loglar tozalandi!"

# AKEM_BOT Docker Makefile

.PHONY: help build up down restart logs logs-bot logs-db status clean backup shell shell-db

# Standart buyruq - yordam ko'rsatish
help:
	@echo "AKEM_BOT Docker buyruqlari:"
	@echo ""
	@echo "ðŸš€ Asosiy buyruqlar:"
	@echo "  make build     - Docker image yaratish"
	@echo "  make up        - Botni ishga tushirish (loglar bilan)"
	@echo "  make up-d      - Botni fonda ishga tushirish"
	@echo "  make down      - Botni to'xtatish"
	@echo "  make restart   - Botni qayta ishga tushirish"
	@echo ""
	@echo "ðŸ“Š Monitoring:"
	@echo "  make logs      - Barcha loglarni ko'rish"
	@echo "  make logs-bot  - Faqat bot loglarini ko'rish"
	@echo "  make logs-db   - Faqat database loglarini ko'rish"
	@echo "  make status    - Konteynerlar holatini ko'rish"
	@echo ""
	@echo "ðŸ› ï¸  Boshqaruv:"
	@echo "  make shell     - Bot konteyneriga kirish"
	@echo "  make shell-db  - PostgreSQL ga kirish"
	@echo "  make backup    - Ma'lumotlar bazasi backup"
	@echo "  make clean     - Barcha konteyner va volumelarni o'chirish"
	@echo ""
	@echo "âš¡ Tez buyruqlar:"
	@echo "  make dev       - Development rejimi (build + up)"
	@echo "  make prod      - Production rejimi (build + up-d)"

# Docker image yaratish
build:
	@echo "ðŸ”¨ Docker image yaratilmoqda..."
	docker compose build

# Botni ishga tushirish (loglar bilan)
up:
	@echo "ðŸš€ Bot ishga tushirilmoqda..."
	docker compose up --build

# Botni fonda ishga tushirish
up-d:
	@echo "ðŸš€ Bot fonda ishga tushirilmoqda..."
	docker compose up -d --build

# Botni to'xtatish
down:
	@echo "â¹ï¸  Bot to'xtatilmoqda..postgres@localhost."
	docker compose down

# Botni qayta ishga tushirish
restart:
	@echo "ðŸ”„ Bot qayta ishga tushirilmoqda..."
	docker compose restart akem-bot

# Barcha loglarni ko'rish
logs:
	@echo "ðŸ“‹ Barcha loglar:"
	docker compose logs -f

# Faqat bot loglarini ko'rish
logs-bot:
	@echo "ðŸ¤– Bot loglari:"
	docker compose logs -f akem-bot

# Faqat database loglarini ko'rish
logs-db:
	@echo "ðŸ—„ï¸  Database loglari:"
	docker compose logs -f postgres_db

# Konteynerlar holatini ko'rish
status:
	@echo "ðŸ“Š Konteynerlar holati:"
	docker compose ps

# Bot konteyneriga kirish
shell:
	@echo "ðŸš Bot konteyneriga kirish..."
	docker compose exec akem-bot bash

# PostgreSQL ga kirish
shell-db:
	@echo "ðŸ—„ï¸  PostgreSQL ga kirish..."
	docker compose exec postgres_db psql -U postgres -d akem_bot

# Ma'lumotlar bazasi backup
backup:
	@echo "ðŸ’¾ Ma'lumotlar bazasi backup yaratilmoqda..."
	@mkdir -p backups
	docker compose exec postgres_db pg_dump -U postgres akem_bot > backups/backup_$(shell date +%Y%m%d_%H%M%S).sql
	@echo "âœ… Backup yaratildi: backups/backup_$(shell date +%Y%m%d_%H%M%S).sql"

# Barcha konteyner va volumelarni o'chirish
clean:
	@echo "ðŸ§¹ Tozalash..."
	docker compose down -v
	docker system prune -f
	@echo "âœ… Tozalandi!"

# Development rejimi
dev: build up

# Production rejimi
prod: build up-d

# Tez test
test:
	@echo "ðŸ§ª Bot testini o'tkazish..."
	docker compose exec akem-bot python -c "print('Bot kodi tekshirildi âœ…')"

# Update - yangi kod bilan qayta ishga tushirish
update:
	@echo "ðŸ”„ Bot yangilanmoqda..."
	docker compose down
	docker compose up --build -d
	@echo "âœ… Bot yangilandi!"

# Logs tozalash
clear-logs:
	@echo "ðŸ§¹ Loglarni tozalash..."
	docker compose down
	docker system prune -f --volumes
	@echo "âœ… Loglar tozalandi!"
